<h1 align="center">Pair 2</h1>
<h3><%=@assignment.title%></h3>
<h4><%=@assignment.description%></h4>
<br>

<% @my_pair = Pair.find(User.find(current_user.id).pairs.where(assignment_id: @assignment.id))%>
<% @my_partner = User.find(@my_pair.users.where.not(id: current_user.id))%>
<% @current_partner = User.find(@my_pair.partner_1)%>
<% @current_partner_submission = Submission.find(Submission.where(assignment_id: @assignment.id, user_id: @current_partner.id))%>


<table>
	<td>
		<div class="field">
			<div id="editor1" style="height: 450px; width: 525px"><%= @current_partner_submission.content%></div>
			<br><br>
		</div>
	</td>

	<td valign="top">
		<table>
		   <tr>
		      <td>
		      	<%length = @current_partner_submission.length%>
		      	<%for i in 1..length%>
			      	<% if !current_user.admin?
			      			@comment = Comment.where(submission_id: @current_partner_submission.id, line_number: i)
					    end%>
					<div>
			         	<%= link_to "+", "#", class: "btn btn-default btn-xs start-conversation", "data-sid" => current_user.id, "data-rip" => @my_partner.id , "data-comid" => @comment.first.id%>
			        </div>
			    <%end%>
			  </td>
		  </tr>
		</table>
	</td>

	<td valign="top">
		<table>
		   <tr>
		      <td>
			    <% @comments = Comment.where(submission_id: @current_partner_submission.id).order('line_number ASC')%>
			    <%=form_for(@current_partner_submission, remote: true, html: {id: "comment_form"}) do |f|%>
			    	<%@comments.each do |comment|%>
			    		<%=f.fields_for :comments, comment do |c|%>
			    			<div>
				    			<%= hidden_field_tag :authenticity_token, form_authenticity_token %>
					            <%= c.text_field :content, :size=>"81", :maxlength=>"94", :class => "lightning", :readonly => true%>
				        	</div>
				        	<div class="chat_<%=comment.id%>">
				        	</div>
				        <%end%>

				    <%end%>

				<%end%>
			</td>
		  </tr>
		</table>
	</td>


</table>


<script src="ace.js" type="text/javascript" charset="utf-8"></script>

<br><br><br>


<script>
  var editor1 = ace.edit("editor1");
  editor1.setTheme("ace/theme/twilight");
  editor1.getSession().setMode("ace/mode/java");
  editor1.setOptions({
    fontSize: "11pt"
  });
  editor1.setReadOnly(true);
    
</script>


	<td>
		<table>
		   <tr>
		      <td>
		         <div style="border: 1px solid black; background-color: #ffffff; padding: 5px;">
		         	<%= link_to "+", "#", class: "btn btn-success btn-xs toggleChatBox", "data-sid" => current_user.id, "data-rip" => @my_partner.id , "data-comid" => 8%>
		         </div>
		         <div class="newboxes-2" id="newboxes1-2" style="border: 1px solid black; background-color: #CCCCCC; display: block;padding: 5px;">Div #1</div>
		      </td>
		  </tr>
		  <tr>
		      <td>
		         <div style="border: 1px solid black; background-color: #ffffff; padding: 5px;">
		            <a id="myHeader2-2" href="javascript:showonlyonev2('newboxes2-2');" >+</a>
		         </div>
		         <div class="newboxes-2" id="newboxes2-2" style="border: 1px solid black; background-color: #CCCCCC; display: none;padding: 5px;">Div #2</div>
		      </td>
		  </tr>
		  <tr>
		      <td>
		         <div style="border: 1px solid black; background-color: #ffffff; padding: 5px;">
		            <a id="myHeader3-2" href="javascript:showonlyonev2('newboxes3-2');" >+</a>
		         </div>
		         <div class="newboxes-2" id="newboxes3-2" style="border: 1px solid black; background-color: #CCCCCC; display: none;padding: 5px;">Div #3</div>
		      </td>
		   </tr>
		</table>
	</td>
</table>


<script language="javascript"> 
	function showonlyonev2(thechosenone) {
	      var newboxes = document.getElementsByTagName("div");
	      for(var x=0; x<newboxes.length; x++) {
	            name = newboxes[x].getAttribute("class");
	            if (name == 'chatbox') {
	                  if (newboxes[x].id == thechosenone) {
	                        if (newboxes[x].style.display == 'block') {
	                              newboxes[x].style.display = 'none';
	                        }
	                        else {
	                              newboxes[x].style.display = 'block';
	                        }
	                  }else {
	                        newboxes[x].style.display = 'none';
	                  }
	            }
	      }
	}
</script>